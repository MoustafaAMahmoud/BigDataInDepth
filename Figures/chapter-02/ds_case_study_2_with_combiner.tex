


\tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

\begin{tikzpicture}[x=0.65pt,y=0.65pt,yscale=-1,xscale=1]
	%uncomment if require: \path (0,221); %set diagram left start at 0, and has height of 221
	
	
	%Shape: Rectangle [id:dp3221278753230701] 
	\draw [color=offred]  (2,60) -- (111,60) -- (111,90) -- (2,90) -- cycle ;
	%Shape: Rectangle [id:dp1271633566749788] 
	\draw [color=offred]  (2,140) -- (111,140) -- (111,170) -- (2,170) -- cycle ;
	%Curve Lines [id:da7576806433421945] 
	\draw  [line width=0.75,color=offwhite]  (112.42,59) .. controls (125,77.7) and (100.24,107.85) .. (128.62,109.05) ;
	
	%Curve Lines [id:da7014275949258858] 
	\draw [line width=0.75,color=offwhite]   (112,161.08) .. controls (125,137.56) and (97.32,110.2) .. (128.44,109.12) ;
	\draw [line width=0.75,color=offwhite] [shift={(130.42,109.08)}, rotate = 180] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Rounded Rect [id:dp8577127496471914] 
	\draw   [color=offpurple] (131,103.47) .. controls (131,101.05) and (132.96,99.08) .. (135.38,99.08) -- (166.03,99.08) .. controls (168.45,99.08) and (170.42,101.05) .. (170.42,103.47) -- (170.42,116.62) .. controls (170.42,119.04) and (168.45,121) .. (166.03,121) -- (135.38,121) .. controls (132.96,121) and (131,119.04) .. (131,116.62) -- cycle ;
	%Rounded Rect [id:dp30434364847793793] 
	%%SPLIT 1
	\draw   [color={rgb, 255:red, 74; green, 144; blue, 226 }] 	(200,60) -- (250,60) -- (250,90) -- (200,90) -- cycle ;
	%Rounded Rect [id:dp4147495296848157] 
	%%SPLIT2
	
	\draw    [color={rgb, 255:red, 74; green, 144; blue, 226 }]  	(200,140) -- (250,140) -- (250,170) -- (200,170) -- cycle ;
	
	%%shuffle and sort
	\draw  [color={rgb, 255:red, 248; green, 231; blue, 28 }  ,draw opacity=1 ] (406,20) -- (460,20) -- (460,200) -- (406,200) -- cycle ;
	
	%Shape: Rectangle [id:dp08196853637328605] 
	\draw  [color={rgb, 255:red, 248; green, 231; blue, 28 }  ,draw opacity=1 ] (411,23) -- (455,23) -- (455,87) -- (411,87) -- cycle ;
	%Shape: Rectangle [id:dp20313277023673393] 
	\draw  [color={rgb, 255:red, 248; green, 231; blue, 28 }  ,draw opacity=1 ] (411,129) -- (455,129) -- (455,196) -- (411,196) -- cycle ;
	
	\draw (412,150) node [anchor=north west][inner sep=0.75pt]  [font=\tiny,color=orange  ,opacity=1 ] [align=left] {(The,\{1,1\}) \\(next,1)\\(very,1)};
	
	\draw (412,33) node [anchor=north west][inner sep=0.75pt]  [font=\tiny,color=orange  ,opacity=1 ] [align=left] {(back,1)\\(cat,1)\\(came,1)\\(day,1)};
	
	%Shape: Parallelogram [id:dp48792900018844987] 
	%%MAP
	\draw  [color=offyellow] (290,55.58) -- (323,55.58) -- (309,84) -- (277,84) -- cycle ;
	%Shape: Parallelogram [id:dp15766656313302363] 
	\draw [color=offyellow]  (290,140) -- (323,140) -- (309,166) -- (277,166) -- cycle ;
	
	%Straight Lines [id:da44147302793163634] 
	\draw  [line width=0.75,color=offwhite]  (251,70.79) -- (276,70.6) ;
	\draw  [line width=0.75,color=offwhite][shift={(280,70.58)}, rotate = 539.53] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	
	
	%Straight Lines [id:da9443785238686285] 
	\draw  [line width=0.75,color=offwhite]  (251,151.79) -- (276,151.6) ;
	\draw [line width=0.75,color=offwhite] [shift={(278.42,151.58)}, rotate = 539.56] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Shape: Rectangle [id:dp016273691107661636] 
	\draw [color={rgb, 255:red, 70; green, 155; blue, 36 }]  (342,47.58) -- (390,47.58) -- (390,106.58) -- (343,106.58) -- cycle ;
	%Straight Lines [id:da747872157663686] 
	\draw  [line width=0.75,color=offwhite]  (317,70) -- (338,70) ;
	\draw  [line width=0.75,color=offwhite] [shift={(340,70.58)}, rotate = 539.53] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Straight Lines [id:da29503611504052674] 
	\draw  [line width=0.75,color=offwhite]  (317,156) -- (338,156) ;
	\draw [line width=0.75,color=offwhite] [shift={(340.42,156.58)}, rotate = 539.53] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Shape: Rectangle [id:dp4945355441436542] 
	%output
	\draw [color={rgb, 255:red, 70; green, 155; blue, 36 }]  (342,121) -- (390,121) -- (390,182.58) -- (343,182.58) -- cycle ;
	%Shape: Rectangle [id:dp7486542282421536] 
	%% outer box
	\draw   (188,20.58) -- (398.42,20.58) -- (398.42,110.58) -- (188,110.58) -- cycle ;
	%Shape: Rectangle [id:dp06285129437676396] 
	%%outerbox
	\draw   (188,110.58) -- (398.42,110.58) -- (398.42,200.58) -- (188,200.58) -- cycle ;
	%Rounded Rect [id:dp7025642442655686] 
	\draw   (414.42,98.18) .. controls (414.42,94.54) and (417.37,91.58) .. (421.02,91.58) -- (444.82,91.58) .. controls (448.46,91.58) and (451.42,94.54) .. (451.42,98.18) -- (451.42,117.98) .. controls (451.42,121.63) and (448.46,124.58) .. (444.82,124.58) -- (421.02,124.58) .. controls (417.37,124.58) and (414.42,121.63) .. (414.42,117.98) -- cycle ;
	%Shape: Rectangle [id:dp7889635565295128] 
	%% outer box
	\draw   (468.42,19.58) -- (670.42,19.58) -- (670.42,110.58) -- (468.42,110.58) -- cycle ;
	%Shape: Rectangle [id:dp8905165615601378] 
	%% outer box
	\draw   (468.42,110.58) -- (670.42,110.58) -- (670.42,200.58) -- (468.42,200.58) -- cycle ;
	%Shape: Rectangle [id:dp38010158785945036] 
	%input
	\draw [color={rgb, 255:red, 74; green, 144; blue, 226 } ]  (471,39.58) -- (523.42,39.58) -- (523.42,100.58) -- (471,100.58) -- cycle ;
	%Shape: Rectangle [id:dp7112194600890194] 
	%input
	\draw  [color={rgb, 255:red, 74; green, 144; blue, 226 } ] (471,127) -- (528.42,127) -- (528.42,187.58) -- (471,187.58) -- cycle ;
	
	%Shape: Parallelogram [id:dp8560234333811613] 
	\draw [color=offpink]  (555,53.58) -- (593,53.58) -- (580,82) -- (544,82) -- cycle ;
	%Shape: Parallelogram [id:dp03185670047818545] 
	\draw [color=offpink]  (555,132.58) -- (593,132.58) -- (580,161) -- (544,161) -- cycle ;
	
	
	%Shape: Rectangle [id:dp7083827174523002] 
	%output
	\draw [color={rgb, 255:red, 70; green, 155; blue, 36 }]  (610,36.58) -- (660,36.58) -- (660,96.58) -- (610,96.58) -- cycle ;
	%Shape: Rectangle [id:dp1906987565798669] 
	%output
	\draw [color={rgb, 255:red, 70; green, 155; blue, 36 }]  (610,130.58) -- (660,130.58) -- (660,180.58) -- (610,180.58) -- cycle ;
	
	%Straight Lines [id:da49186429007848953] 
	\draw  [line width=0.75,color=offwhite]  (523.21,69.79) -- (546.42,69.6) ;
	\draw [line width=0.75,color=offwhite] [shift={(548.42,69.58)}, rotate = 539.53] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Straight Lines [id:da9429141358329266] 
	\draw  [line width=0.75,color=offwhite]  (583.21,67.79) -- (603.42,67.6) ;
	\draw [line width=0.75,color=offwhite] [shift={(605.42,67.58)}, rotate = 539.46] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Straight Lines [id:da955760701625054] 
	\draw [line width=0.75,color=offwhite]   (586.21,146.79) -- (606.42,146.6) ;
	\draw [line width=0.75,color=offwhite] [shift={(608.42,146.58)}, rotate = 539.46] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Straight Lines [id:da4689003855145568] 
	\draw [line width=0.75,color=offwhite]   (528.21,147.79) -- (546.42,147.6) ;
	\draw [line width=0.75,color=offwhite] [shift={(548.42,147.58)}, rotate = 539.4100000000001] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Curve Lines [id:da21391955631880766] 
	\draw [line width=0.75,color=offwhite]   (454,108) .. controls (469.19,89.86) and (442.25,98.32) .. (466.28,70.86) ;
	\draw [line width=0.75,color=offwhite] [shift={(467.42,69.58)}, rotate = 491.88] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Curve Lines [id:da1946353683290437] 
	\draw [line width=0.75,color=offwhite]   (454,108) .. controls (464.9,117.15) and (454.45,140.36) .. (463.94,148.53) ;
	\draw [line width=0.75,color=offwhite] [shift={(465.42,149.58)}, rotate = 210.26] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Curve Lines [id:da6948926407425784] 
	\draw [line width=0.75,color=offwhite]   (398,68) .. controls (408,91.6) and (400.11,103.6) .. (413.61,110.72) ;
	\draw [line width=0.75,color=offwhite] [shift={(415.42,111.58)}, rotate = 203.63] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Curve Lines [id:da5460745178214813] 
	\draw  [line width=0.75,color=offwhite]  (398.42,138.58) .. controls (413.22,124.74) and (399.6,114.44) .. (413.53,111.86) ;
	\draw  [line width=0.75,color=offwhite] [shift={(415.42,111.58)}, rotate = 533.29] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Curve Lines [id:da3401941808176002] 
	\draw  [line width=0.75,color=offwhite]  (172,100) .. controls (180.25,88.81) and (159.28,65.54) .. (186.68,65.55) ;
	\draw [line width=0.75,color=offwhite] [shift={(188.42,65.58)}, rotate = 181.91] [color=offwhite  ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	%Curve Lines [id:da46994249585601144] 
	\draw  [line width=0.75,color=offwhite]  (172,100) .. controls (180.25,109.39) and (159.28,133.59) .. (185.74,135.49) ;
	\draw [line width=0.75,color=offwhite] [shift={(187.42,135.58)}, rotate = 181.97] [color=offwhite ][line width=0.75]    (10.93,-3.29) .. controls (6.95,-1.4) and (3.31,-0.3) .. (0,0) .. controls (3.31,0.3) and (6.95,1.4) .. (10.93,3.29)   ;
	
	% Text Node
	\draw (4,67) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offred] {The cat came back};
	% Text Node
	\draw (41,90) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offred] {split-1};
	% Text Node
	\draw (4,149) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offred] {The very next day};
	% Text Node
	\draw (41,174) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offred] {split-2};
	
	
	% Text Node
	\draw (133,102.08) node [anchor=north west][inner sep=0.75pt]   [align=left,color=offpurple] {{\scriptsize S \% n}};
	
	% Text Node
	\draw (205,66) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize,color=offred] [align=left] {split-1};
	% Text Node
	\draw (205,146) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize,color=offred] [align=left] {split-2};
	
	% Text Node
	\draw (285,65) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {map};
	% Text Node
	\draw (285,146) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {map};
	
	% Text Node
	\draw (270,98) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offgreen2] {Node 1};
	% Text Node
	\draw (270,112) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offgreen2] {Node 2};
	
	% Text Node
	\draw (342,50.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {(The,1) \\(cat,1)\\(came,1) \\(back,1)};
	% Text Node
	\draw (341,124) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {(The,1) \\(very,1)\\(next,1) \\(day,1)};
	
	% Text Node
	\draw (205,36) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 74; green, 144; blue, 226 } ] {input};
	% Text Node
	\draw (205,185.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 74; green, 144; blue, 226 } ] {input};
	
	% Text Node
	\draw (340,34) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 70; green, 155; blue, 36 }] {output};
	% Text Node
	\draw (340,186) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 70; green, 155; blue, 36 }] {output};
	
	% Text Node
	\draw (416,95) node [anchor=north west][inner sep=0.75pt]  [font=\tiny] [align=left] {Shuffle \\\& Soft};
	% Text Node
	
	
	\draw (470,42.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {(back,1)\\(cat,1)\\(came,1)\\(day,1)};
	% Text Node
	\draw (470,130) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow ] {(The,\{1,1\})\\(next,1)\\(very,1)};
	
	
	
	% Text Node
	\draw (551,64) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offpink] {count};
	% Text Node
	\draw (551,142) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offpink] {count};
	
	
	% Text Node
	\draw (610,39.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offpink] {(back,1) \\(cat,1)\\(came,1)\\(day,1)};
	% Text Node
	\draw (610,132) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offpink] {(The,2)\\(next,1)\\(very,1)};
	
	% Text Node
	\draw (286,184.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {fn};
	% Text Node
	\draw (286,34.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offyellow] {fn};
	
	% Text Node
	\draw (552.22,112.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offgreen2] {Node 2};
	% Text Node
	\draw (552.22,97.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offgreen2] {Node 1};
	
	% Text Node
	\draw (610,24) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 70; green, 155; blue, 36 }] {output};
	% Text Node
	\draw (610,182) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 70; green, 155; blue, 36 }] {output};
	
	% Text Node
	\draw (560,186.33) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offpink] {fn};
	% Text Node
	\draw (560,26.58) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color=offpink] {fn};
	
	% Text Node
	\draw (470,27) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 74; green, 144; blue, 226 } ] {input};
	% Text Node
	\draw (470,188) node [anchor=north west][inner sep=0.75pt]  [font=\scriptsize] [align=left,color={rgb, 255:red, 74; green, 144; blue, 226 } ] {input};
	
	
	\draw (520.22,208) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize] [align=left] {Reduce side};
	\draw (260,208) node [anchor=north west][inner sep=0.75pt]  [font=\footnotesize] [align=left] {Map side};
	
\end{tikzpicture}
